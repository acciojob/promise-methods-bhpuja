<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Promise Methods</title>
</head>
<body>
    <h1>Testing Custom Promise Methods</h1>
    <pre id="output"></pre>

    <script>
        // Implementing the custom Promise methods

        // myRace
        Promise.myRace = function (promises) {
            return new Promise((resolve, reject) => {
                promises.forEach(promise => {
                    Promise.resolve(promise).then(resolve, reject);
                });
            });
        };

        // myAny
        Promise.myAny = function (promises) {
            let rejections = 0;
            return new Promise((resolve, reject) => {
                promises.forEach(promise => {
                    Promise.resolve(promise).then(resolve, () => {
                        rejections++;
                        if (rejections === promises.length) {
                            reject("all promises rejected");
                        }
                    });
                });
            });
        };

        // myAll
        Promise.myAll = function (promises) {
            let results = [];
            let completed = 0;
            return new Promise((resolve, reject) => {
                promises.forEach((promise, index) => {
                    Promise.resolve(promise).then(value => {
                        results[index] = value;
                        completed++;
                        if (completed === promises.length) {
                            resolve(results);
                        }
                    }).catch(reject);
                });
            });
        };

        // myAllSettled
        Promise.myAllSettled = function (promises) {
            let results = [];
            let completed = 0;
            return new Promise(resolve => {
                promises.forEach((promise, index) => {
                    Promise.resolve(promise).then(value => {
                        results[index] = { status: "fulfilled", value };
                    }).catch(error => {
                        results[index] = { status: "rejected", error };
                    }).finally(() => {
                        completed++;
                        if (completed === promises.length) {
                            resolve(results);
                        }
                    });
                });
            });
        };

        // Test cases
        const output = document.getElementById('output');

        function logOutput(result) {
            output.textContent += result + '\n';
        }

        // myRace
        Promise.myRace([
            new Promise(res => setTimeout(() => res(0), 500)),
            Promise.resolve(5),
            new Promise(res => setTimeout(() => res(10), 1000)),
        ]).then(logOutput).catch(error => logOutput('error: ' + error));

        // myAny
        Promise.myAny([
            new Promise(res => setTimeout(() => res(0), 500)),
            Promise.resolve(5),
            new Promise(res => setTimeout(() => res(10), 1000)),
        ]).then(logOutput).catch(error => logOutput('error: ' + error));

        // myAll
        Promise.myAll([
            new Promise(res => setTimeout(() => res(0), 500)),
            Promise.resolve(5),
            new Promise(res => setTimeout(() => res(10), 1000)),
        ]).then(result => logOutput(JSON.stringify(result)))
          .catch(error => logOutput('error: ' + error));

        // myAllSettled
        Promise.myAllSettled([
            new Promise(res => setTimeout(() => res(0), 500)),
            Promise.reject(5),
            new Promise(res => setTimeout(() => res(10), 1000)),
        ]).then(result => logOutput(JSON.stringify(result)));
    </script>
</body>
</html>
